{"code":"/**\r\n * @Description : create portal component\r\n * @Create on : 2019/11/18 22:54\r\n * @author liuyunjs\r\n * @version 0.0.1\r\n **/\r\nimport * as React from 'react';\r\nimport StaticAction from './static';\r\nexport default function portalHOC(Component) {\r\n    const staticAction = new StaticAction();\r\n    return class Portal extends React.PureComponent {\r\n        constructor() {\r\n            super(...arguments);\r\n            this.child = React.createRef();\r\n            this.close = () => this.child.current && this.child.current.close && this.child.current.close();\r\n            this.onChange = (visible) => {\r\n                if (!visible) {\r\n                    this.key && staticAction.hide(this.key);\r\n                    this.key = undefined;\r\n                }\r\n                const { onChange } = this.props;\r\n                onChange && onChange(visible);\r\n            };\r\n        }\r\n        // static show(component: React.ReactNode): string {\r\n        //   return staticAction.show(\r\n        //     <Component>\r\n        //       {component}\r\n        //     </Component>,\r\n        //   );\r\n        // }\r\n        static hide() {\r\n            staticAction.hide();\r\n        }\r\n        componentDidMount() {\r\n            if (this.props.visible) {\r\n                this.show();\r\n            }\r\n        }\r\n        componentDidUpdate(prevProps) {\r\n            if (prevProps.visible !== this.props.visible) {\r\n                if (this.props.visible) {\r\n                    return this.show();\r\n                }\r\n                this.close();\r\n            }\r\n        }\r\n        componentWillUnmount() {\r\n            this.key && staticAction.hide(this.key);\r\n        }\r\n        show() {\r\n            this.key = staticAction.show((React.createElement(Component, Object.assign({}, this.props, { ref: this.child, onChange: this.onChange }))));\r\n        }\r\n        render() {\r\n            return null;\r\n        }\r\n    };\r\n}\r\n","references":["/Users/liuyunjs/Documents/projects/portal/node_modules/@types/react/index.d.ts","/Users/liuyunjs/Documents/projects/portal/node_modules/@types/react/index.d.ts","/Users/liuyunjs/Documents/projects/portal/src/portal/static.ts","/Users/liuyunjs/Documents/projects/portal/src/portal/types.ts"]}
